# 브라우저의 동작 원리

## 브라우저 동작 원리 상세 설명

### 브라우저의 주요 구성 요소

1. 사용자 인터페이스 - 주소 표시줄, 이전/다음 버튼, 북마트 등 사용자가 조작하는 부분
2. 브라우저 엔진 - 사용자 인터페이스와 렌더링 엔진 사이의 동작을 제어
3. 렌더링 엔진 - HTML, CSS를 파싱하여 화면에 표시
4. 네트워킹 - HTTP 요청과 같은 네트워크 호출에 사용
5. 자바스크립트 엔진 - 자바스크립트 코드를 해석하고 실행 (예: V8 엔진)

    - V8 엔진이란?
      Google에서 개발한 오픈 소스 JavaScript 엔진으로, 주로 Goolge Chrome 브라우저와 Node.js에서 사용된다.
      주요 목적은 JavaScript 코드를 빠르게 실행하는 것이다.

        V8의 핵심 특징 중 하나는 JIT(Just-In-Time) 컴파일 기술이다.
        이 기술을 통해 V8은 JavaScript 코드를 직접 기계어로 컴파일하여 실행 속도를 크게 향상시킨다.
        전통적인 인터프리터 방식과 달리, JIT 컴파일은 코드를 실행하면서 동시에 컴파일하기 때문에 더 빠른 실행 속도를 제공한다.

        V8의 주요 구성 요소로는

        1. Parser: JavaScript 코드를 파싱하여 AST(Abstract Syntax Tree)를 생성한다.
        2. Interpreter (Ignition): AST를 바이트코드로 변환하고 실행한다.
        3. Compiler (TurboFan): 자주 실행되는 코드를 최적화된 기계어로 컴파일한다.
        4. Garbage Collector: 더 이상 사용하지 않는 메모리를 자동으로 회수한다.

        V8의 JavaScript 실행 과정

        1. JavaScript 코드가 Parser에 의해 AST로 변환된다.
        2. Ignition이 이 AST를 바이트코드로 변환하고 실행한다.
        3. 코드가 자주 실행되면 ("hot"해지면), TurboFan이 이를 최적화된 기계어로 컴파일한다.
        4. 런타임 중 코드 실행 패턴을 계속 분석하여 추가적인 최적화를 수행한다.

        V8의 성능 향상을 위해 사용하는 여러가지 최적화 기법

        1. 인라인 캐싱: 객체의 프로퍼티에 빠르게 접근할 수 있도록 한다.
        2. 히든 클래스: 동적 프로퍼티를 효율적으로 처리한다.
        3. 인라인화: 작은 함수 호출을 함수 본문으로 대체하여 호출 오버헤드를 줄인다.

        V8은 효율적인 가비지 컬렉션을 통해 메모리를 관리하는데, 가비지 컬렉터는 더 이상 사용되지 않는 객체를 식별하고 제거하여 메모리 누수를 방지한다.

6. UI 백엔드: 기본적인 위젯(콤보 박스 등)을 그리는 데 사용
7. 데이터 저장소: 쿠키 등의 데이터를 저장하는 계층

### 렌더링 엔진의 동작 과정

1. DOM(Document Object Model) 트리 구축
    - HTML 문서 파싱
    - 태그를 DOM 노드로 변환
    - DOM 트리 생성
2. CSSOM(CSS Object Model) 트리 구축
    - CSS 파일과 스타일 요소 파싱
    - CSSOM 트리 생성
3. 렌더 트리(Render Tree) 구축
    - DOM과 CSSOM을 결합
    - 화면에 표시되는 모든 노드의 콘텐츠와 스타일 정보를 포함
4. 레이아웃(Layout)
    - 각 노드의 정확한 위치와 크기 계산
    - 상대적인 측정값을 절대적인 픽셀로 변환
5. 페인팅(Painting)
    - 실제 화면에 픽셀을 그리는 과정
    - 텍스트, 색, 이미지, 테두리 및 그림자 등을 그림
6. 컴포지팅(Compositing)
    - 여러 레이어를 합성하여 최종 화면 생성

### JavaScript 실행

1. 파싱 - 소스 코드를 추상 구문 트리(AST)로 변환
2. 컴파일 - AST를 바이트코드로 변환
3. 실행 - 바이트코드 실행
4. 최적화 - 자주 실행되는 코드는 기계어로 컴파일 (JIT 컴파일)

### 리플로우(Reflow)와 리페인트(Repaint)

-   리플로우 - 레이아웃 변경 시 발생. 요소의 위치와 크기 재계산
-   리페인트 - 스타일 변경 시 발생. 요소의 시각적 속성만 업데이트

### 브라우저의 최적화 기법

1. 증분 HTML파싱 - 전체 HTML을 기다리지 않고 부분적으로 파싱 및 렌더링
2. 스펙큘레이티브 파싱 - JavaScript 실행 중에도 다음 HTML을 미리 파싱
3. 레이아웃 스레싱 방지 - 여러 DOM 변경을 일괄 처리

<hr/>

## 브라우저 동작 원리

1. URL 입력 - 사용자가 브라우저의 주소 표시줄에 URL을
2. DNS 조회 - 브라우저는 입력된 도메인 이름을 IP 주소로 변환하기 위해 DNS(Domain Name System) 서버에 쿼리를 보냅니다.
3. TCP 연결: IP 주소를 얻은 후, 브라우저는 해당 서버와 TCP(Transmaission Control Protocol) 연결을 설정한다.
4. HTTP 요청: 연결이 설정되면, 브라우저는 서버에 HTTP 요청을 보낸다.
5. 서버 응답: 서버는 요청을 처리하고 응답을 보낸다. 일반적으로 HTML, CSS, JavaScript 파일 등을 포함한다.
6. 콘텐츠 다운로드: 브라우저는 서버로부터 받은 데이터를 다운로드한다.
7. 렌더링: 다운로드한 콘텐츠를 화면에 포시한다. 이 과정은 복잡하며, DOM 트리 구축, CSSOM 트리 구축, 렌더 트리 생성, 레이아웃, 페인팅 등의 단계를 포함한다.
   렌더링 과정은 매우 중요하다.
   HTML은 DOM 트리로, CSS는 CSSOM트리로 변환된다.
   이 두 트리가 결합되어 렌더 트리를 형성하고, 이를 기반으로 각 노드의 정확한 위치와 크기가 계산된다(레이아웃.)
   마지막으로 이 정보를 바탕으로 실제 픽셀을 화면에 그리는 페인팅 과정이 이루어진다.
